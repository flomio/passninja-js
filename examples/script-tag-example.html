<html>
  <link
    href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <!-- TODO: This should be a CDN source. -->
  <script src="../dist/passninja.umd.js"></script>

  <body>
    <div class="container mx-auto py-6 px-4">
      <h1 class="text-3xl py-4 border-b mb-10">Create PassNinja Pass Example</h1>
      <div class="mb-4 flex justify-between items-center">
        <div class="flex-1 pr-4">
          <div class="shadow overflow-hidden rounded border-b border-gray-200">
            <table class="min-w-full bg-white">
              <thead id="headers" class="bg-gray-800 text-white"></thead>
              <tbody id="data"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Check https://passninja.com/auth/profile for your credentials
      // The below are demo user credentials
      const accountId = '3a6bc54c-78be-4d63-b804-3164597cae4c';
      const apiKey = 'lw9BrOkj4O9owCzuwZXzC3kGdAXg8SN01yYmxIGf';

      const passNinjaClient = new passninja.PassNinjaClient(accountId, apiKey);

      passNinjaClient.pass
        .create({
          passType: 'demo.coupon',
          pass: {
            discount: '100%',
            memberName: 'Auston',
          },
          expires: new Date(2020, 09, 12),
        })
        .then((data) => {
          console.log(JSON.stringify(data, 0, 2));
          const tableHead = document.getElementById('headers');
          const tableData = document.getElementById('data');
          const dataRow = document.createElement('tr');
          console.log(Object.keys(data));
          Object.keys(data).forEach((key) => {
            let entry = data[key];

            const header = document.createElement('th');
            header.className =
              'w-1/3 py-3 px-4 uppercase font-semibold text-sm';
            header.innerText = key;
            tableHead.appendChild(header);

            const dataCell = document.createElement('td');
            dataCell.className = 'w-1/3 text-left py-3 px-4';

            if (key === 'urls') {
              entry = data[key].landing;
              const ahref = document.createElement('a');
              ahref.href = entry;
              ahref.className = 'hover:text-blue-500';
              ahref.innerText = 'Install Page';
              dataCell.appendChild(ahref);
              console.log(ahref);
            } else {
              entry = typeof entry === 'string' ? entry : JSON.stringify(entry);
              dataCell.innerText = entry;
            }

            dataRow.appendChild(dataCell);
          });
          tableData.appendChild(dataRow);
        })
        .catch((err) => console.log(err));
    </script>
  </body>
</html>
